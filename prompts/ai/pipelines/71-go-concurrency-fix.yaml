version: "1.0.0"
title: "Go Concurrency Fix"
description: "Debug deadlocks and race conditions in Go."
instructions: |
  Diagnose and resolve concurrency issues in Go applications.
  1. Analyse the code for race conditions using Agent 71.
  2. Visualise the Goroutine interactions using Agent 29.
  3. Refactor the channel logic to ensure safety using Agent 71.
    
parameters:
  - key: package_path
    input_type: string
    requirement: required
    description: "Path to the Go package."
  - key: issue_type
    input_type: string
    requirement: required
    description: "Type of issue (Deadlock, Race, Leak)."

sub_recipes:
  - name: "agent_71_the_gopher"
    path: "./agents/71-the-gopher.yaml"
  - name: "agent_29_the_visualisation_expert"
    path: "./agents/29-the-visualisation-expert.yaml"

extensions:
  - type: builtin
    name: developer
    timeout: 300
    bundled: true

prompt: |
  Fix {{ issue_type }} in {{ package_path }}.
    
  1. 'agent_71_the_gopher': Run the race detector (`go test -race`) and analyse the output.
  2. 'agent_29_the_visualisation_expert': Map out the channel communication to identify blocking points.
  3. 'agent_71_the_gopher': Rewrite the select statements and wait groups to resolve the {{ issue_type }}.
